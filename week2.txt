18.409 An Algorithmist’s Toolkit September 15, 2007 
Lecture 2 
Lecturer: Jonathan Kelner Scribe: Mergen Nachin 2009 
1 Administrative Details 
• Signup online for scribing. 
2 Review of Lecture 1 
All of the following are covered in detail in the notes for Lecture 1: 
•	The deﬁnition of LG, speciﬁcally that LG = DG − AG, where DG is a diagonal matrix of degrees and 
AG is the adjacency matrix of graph G. 
• The action of LG on a vector x, namely that 
[LGx]i = deg(i) (xi − average of x on neighbors of i) 
•	The eigenvalues of LG are λ1 ≤ ··· ≤ λn with corresponding eigenvectors v1,...,vn. The ﬁrst and the 
most trivial eigenvector is v1 = 1 with an eigenvalue λ1 = 0. We are mostly interested in v2 and λ2. 
3 Properties of the Laplacian 
3.1 Some simple properties 
Lemma 1 (Edge Union) If G and H are two graphs on the same vertex set with disjoint edge sets, 
LG∪H = LG + LH (additivity)	 (1) 
Lemma 2 (Isolated Vertices) If a vertex i ∈ G is isolated, then the corresponding row and column of the 
Laplacian are zero, i.e. [LG]i,j = [LG]j,i = 0 for all j. 
Lemma 3 (Disjoint Union) These together imply that the Laplacian of the disjoint union of G and H is 
direct sum of LG and LH , i.e.: 
 
‘ LL = L⊕ L= �
G 0 
G H G H 0 LH	� 
(2) 
Proof Consider the graph G � v(H) = (VG ∪ VH ,EG), namely the graph consisting of G along with the 
vertex set of H as disjoint vertices. Deﬁne v(G) � H similarly. By the second remark, 
� 	   LG 0	� �0 0 LG�v(H) = and L�
. 0 0v(G)�H = 0 LH 
By deﬁnition, G � H = (G � v(H)) ∪ (v(G) � H), and so by the ﬁrst remark: 
�  
	 LG 0‘  LG H = LG ⊕ LH =�
. 0 LH 
This implies the Laplacian is the direct sum of the Laplacians of the connected components. Thus, 
2-1 � � � � 
� � � Theorem 4 (Disjoin t Union Spectrum) If LG has eigenve ctors v1,...,vn with eigenvalues λ1,...,λn, 
and LH has eigenve ctors w1,...,wn with eigenvalues µ1,...,µn, then LG�H has eigenve ctors: 
v1 ⊕ 0,...,vn ⊕ 0, 0 ⊕ w1,..., 0 ⊕ wn 
with corresponding eigenvalues: 
λ1,...,λn,µ1,...,µn. 
Proof By the previous lemma, 
� �� �� � 
LG ‘ H ∗ (v1 ⊕ 0)= LG 0 v1 = λ1v1 
0 LH 0 0 
Thus v1 ⊕ 0 is an eigen vector of LG�H with eigen value λ1. The rest follow by symmetry . 
3.2 The Laplacian of an edge 
Deﬁnition 5 Let Le be the Laplacian of the graph on n vertic es consisting of just the edge e. 
Example 1 If e is the edge (v1,v2), then 
⎛ ⎞ 1 −10 0
⎜ 10 0 ⎟
⎜ −1 ⎟··· 
⎜ 0 00 0 ⎟Le = ⎜ ⎟ . ⎜ . . . ⎟ ⎝ .. .... ⎠ 
0 00 0··· 
By additivit y, this lets us write: � 
LG = Le (3) 
e∈E 
This will allow us to prove a number of facts about the Laplacian by proving them for one edge and 
adding them up. The more general technique, which we’ll use more later, is to bound Laplacians by adding 
matrices of substructures. 
So for an edge e, �� 
Le = −1
1 −1 ⊕ [zeros] .1 
Note that: � ��� �� 
1 −
11= 1 � 1 −1 � 
=2 √1
21� 
√1
2 − √1
2 � 
,−1 −1 − √
2 
� �T 
and so √1
2 − √1
2 is an eigen vector with eigen value 2. This decomp osition implies: 
x T Lex = � x1 x2 � 
−1
1 � 1 −1 � x
x1
2 =(x1 − x2)2 . (4) 
Remark The Laplacian is a quadratic form, speciﬁcally: 
x T LGx = x T ( Le)x = x T Lex = (xi − xj )2 (5) 
e∈E e∈E (i,j)∈E 
This implies that L is positive semideﬁnite . 
2-2 � 3.3 Review of Positiv e Semideﬁniteness 
Deﬁnition 6 A symmetric matrix M is positiv e semideﬁnite (PSD) if ∀x ∈ Rn , 
x T Mx ≥ 0. 
M is positiv e deﬁnite (PD) if the inequality is strict ∀x =0�. 
Lemma 7 M is PSD iﬀ all eigenvalues λi ≥ 0. Similarly M is PD iﬀ all eigenvalues λi > 0. 
Proof Let’s consider the matrix M in its eigen basis, that is M = QT ΛQ. Clearly , yT Λy = i λiyi 2 ≥ 0 
for all y ∈ Rn iﬀ λi ≥ 0 for all i. Similar for PD matrix. 
Lemma 8 (PSD Matrix Decomp osition) M is PSD iﬀ there exists a matri x A such that 
M = AT A. (6) 
Note that A can be (n × k) for any k, and that it need not be squar e. Importantly, note that A is not unique. 
Proof 
()If M is positiv e semideﬁnite, recall that M can be diagonalized as ⇒
M = QT ΛQ, 
thus ��T �� 
M = QT Λ1/2Λ1/2Q =Λ1/2Q Λ1/2Q, 
where Λ1/2 has √λi on the diagonal. 
()If M = AT A, then ⇐
x T Mx = x T AT Ax =(Ax)T (Ax) 
Letting y =(Ax) ∈ Rk, we see that: 
x T Mx = y T y = ||y||2 ≥ 0. 
3.4 Factoring the Laplacian 
We know from the previous section that we can factor L as AT A using eigen vectors , but there also exists a 
much nicer factorization which we will show here. 
Deﬁnition 9 Let m be the numb er of edges and n be the numb er of vertic es. Then the incidence matrix 
� = �G is the m × n matrix given by: 
⎧ 
⎨ 1 if e =(v, w) and v<w 
�e,v = ⎩ −1 if e =(v, w) and v>w (7) 
0 otherwise. 
2-3 • �
• �
� Example 2 The Laplacian and the Incidenc e matrix of the graph G= 
  34
2ab
c1
⎛	 ⎞ 
⎜ 3 −
11 −
01 −
01 
⎟⎛ 1 −10 0 ⎞ 
is LG = ⎜ −1 ⎟ = ⎝ 10 −10 ⎠ ⎝	−10 1 0 ⎠ �G 
−10 0 1 10 0 −1 
Lemma 10 LG = �T �. 
��	 ���� � 
Proof Observ e that �T � ij =(ith column of �)·(jth column of �)= e [�]e,vi [�]e,vj This gives 
three cases : 
When i = j,•	
� ��� �2 � T�	� = [�] = 1= deg(i).ij e,vi 
e e inciden t to vi 
When i = j and no edge exists between vi and vj , 
� ��� �� � 
�T � ij = [�]e,vi [�]e,vj =0 
e 
as every edge is non-inciden t to at least one of vi,vj . 
When i = j and exists an edge e� between vi and vj , 
������ �� �� � 
�T � ij = [�]e,vi [�]e,vj =[�]e�,vi [�]e�,vj = −1. 
e 
Corollary 11 Note that	� 
x T LGx = ||�x||2 = (xi − xj )2 , 
(i,j)∈E 
This gives another proof that L is PSD. 
3.5 Dimension of the Null Space 
Theorem 12 If G is conne cted, the null space is 1-dimensional and spanned by the vector 1. 
Proof Let x ∈ null(L ), i.e. LGx = 0. This implies 
x T LGx = (xi − xj )2 =0. 
(i,j)∈E 
Thus, xi = xj for every (i, j) ∈ E. As G is connected, this means that all xi are equal. Thus every member 
of the null space is a multiple of 1. 
Corollary 13 If G is conne cted, λ2 > 0. 
Corollary 14 The dimension of the null space of LG is exactly the numb er of connected components of G. 
2-4 � � 
�4 Spectra of Some Common Graphs 
We compute the spectra of some graphs: 
Lemma 15 (Complete graph) The Laplacian for the complete graph Kn on n vertic es has eigenvalue 0 
with multiplicity 1 and eigenvalue n with multiplicity n − 1 and associate d eigensp ace {x|x · 1 =0}. 
Proof By corollary 13, we conclud e that eigen value 0 has multiplicit y 1. Now, take any vector v which is 
orthogonal to 1 and consider [LKn v]i. Note that this value is equal to 
(n − 1)vi − vj = nvi − vj = nvi 
j=i j 
Hence any vector v which is orthogonal to 1 is an eigen vector with an eigen value n. 
Lemma 16 (Ring graph) The Laplacian for the ring graph Rn on n vertic es has eigenve ctors 
xk(u) = sin(2πku/n), and 
yk(u) = cos(2πku/n) 
for 0 ≤ k ≤ n/2. Both xk and yk have eigenvalue 2 − 2 cos(2πk/n). Note that, x0 = 0 should be ignor ed and 
y0 is 1, and when n is even xn/2 = 0 should be ignor ed and we only have yn/2. 
Proof . The best way to see is to plot the graph on the circle using these vectors as coordinates. Below is 
the plot for a k = 3. 
Just consider vertex 1. Keep in mind that sin(2x ) = 2 sin(x ) cos(x). Then, 
[Lxk]1	=2xk(1) − xk(0) − xk(2) 
= 2 sin(2πk/n) − 0 − sin(2πk2/n) 
= 2 sin(2πk/n) − 2 sin(2πk/n) cos(2πk/n) 
= (2 − 2 cos(2πk/n)) sin(2πk/n) 
= (2 − 2 cos(2πk/n))xk(1) 
Note that this shows that x(u)= �(e2πi(ku+c)/n) is an eigen vector for any k ∈ Z,c ∈ C. 
Lemma 17 (Path graph) The Laplacian for the path graph Pn on n vertic es has the same eigenvalues as 
R2n and eigenve ctors 
vk(u) = sin(πku/n + π/2n) 
for 0 ≤ k<n 
2-5 � 
� 
�	 � Proof 
  0 1 2 3 4P5R10
01 2 3
4
5
6 7 89
We will realize Pn as quoti ent of R2n. Supp ose z was an eigen vector of LR2n in which zi = z2n−1−i for 
0 ≤ i<n. Take the ﬁrst n comp onents of z and call this vector v. Note that for 0 <i<n: 
[LPn v]i	= 2(vi − neigh bors of i in Pn) 
= 2(zi − neigh bors of i in R2n) 
=(zi − neigh bors of i in R2n)+(z2n−i−1 − neigh bors of (2n − i − 1) in R2n) 
1 = 2([LR2n z]i +[LR2n z]2n−i−1) 
1 = 2(λzi + λz2n−i−1) 
= λzi
= λvi
Now consider the case when i = 0. 
[LPn v]0	= v0 − v1 
=2v0 − v1 + v0 
=2z0 − z1 + z0 
=2z0 − z1 + z2n−1 
= λz0 
= λv0 
Hence, v is an eigen vector of LPn . Now we show that such v exists, that is, there exists eigen vector z of 
LR2n in which zi = z2n−1−i for 0 ≤ i<n. Take z, 
zk(u)	= sin(πku/n + π/2n) 
= sin(πku/n) cos(π/2n) + cos(πku/n) sin(π/2n) 
= xk(u) cos(π/2n) + yk sin(π/2n) 
We see that zk is in the span of xk and yk. Hence, zk is an eigen vector of LR2n with an eigen value 
2 − 2 cos(2πk/n) by lemma 16. Chec k that zk satisﬁes zk(i)= zk(2n − 1 − i) 
4.1	 Graph Products 
The next natural example is the grid graph, which will follow from general theory about product graphs. 
2-6 Deﬁnition 18 Let G =(V, E), and H =(W, F ). The product graph G × H has vertex set V × W and edge 
set: 
((v1,w), (v2,w)) , ∀(v1,v2) ∈ E, w ∈ W and 
((v, w1), (v, w2)) , ∀(w1,w2) ∈ F, v ∈ V. 
Example 3 Pn × Pm = Gn,m. We see that the vertic es of Pn × Pm are: 
⎧
⎪⎪⎪⎨ (v1, w1) (v1, w2) · · · (v1, wm) 
(v2, w1) (v2, w2) · · · (v2, wm) 
. . . . . . ... . . . 
(vn, w1) (vn, w2) · · · (vn, wm) ⎫
⎪⎪⎪⎬ 
v(Gn,m)= ⎪⎪⎪
⎩ ⎪⎪⎪⎭ 
The vertic es are written in the above layout because it makes the edges intuitive. The edges are: 
• For a ﬁxed w, i.e. a column in the above layout, a copy of Pn. 
• For a ﬁxed v, i.e. a row in the above layout, a copy of Pm. 
Thus Pn × Pm = Gn,m, which is to say the product of two path graphs is the grid graph. 
Theorem 19 (Graph Products) If LG has eigenve ctors v1,...,vn with eigenvalues λ1,...,λn, and LH 
has eigenve ctors w1,...,wk with eigenvalues µ1,...,µk, then LG×H has, for all 1 ≤ i ≤ n, 1 ≤ j ≤ k, an 
eigenve ctor: 
zij (v, w)= xi(v)yj (w) 
of eigenvalue λi + µj . 
Note importan tly that eigen values add here, they do not multipl y.
Proof Let Am be the graph with m isolated vertices. We can then decomp ose the product as:
G × H =(G × Ak) ∪ (An × H), 
i.e. the edge union of k disjoin t copies of G and n disjoin t copies of H, exactly as in the deﬁnition. By 
Lemmas 1 and 3 we have 
LG×H = LG×Ak + LAn×H = LG ⊗ Ik + In ⊗ LH 
Consider zij = xi ⊗ yj as above for a ﬁxed i and j, we see that: 
LG×H zij =(LG ⊗ Ik)(xi ⊗ yj )+(In ⊗ LH )(xi ⊗ yj ) 
=(λixi ⊗ yj )+(xi ⊗ µj yj ) 
=(λi + µj )(xi ⊗ yj )=(λi + µj )zij . 
Corollary 20 Gn,m has eigenve ctors and eigenvalues completely determi ned by those of Pn and Pm as above. 
Why is this called the Laplacian? 
It turns out that the graph Laplacian is very naturally related to the continuous Laplacian. 
d •	In 1 dimension, the continuous Laplacian is dx .
d2 f + d2f
• In 2 dimensions, the continuous Laplacian is �f = dx2 dy2 . 
2-7 5 5.1 Discretizing Deriv atives, 1d case 
Consider a 1d function f : R → R, which we wish to discretize at the points (...,k−2,k−1, k, k+1,k+2,...): 
We appro ximate the ﬁrst deriv ative at the line midpoints, df , up to scaling, by taking the diﬀerences dx 
between the values at the adjacen t points: 
The discrete ﬁrst deriv ative of f is a function on edges, and is, up to scaling �Pn f, the incidence matrix 
d2fof Pn deﬁned earlier. In order to compute the second deriv ative at the original points, dx2 , again up to 
scaling, we take the diﬀerences of the adjacen t midpoints at the vertices: 
The discrete second deriv ative of f is thus, up to scaling, −LPn f. 
5.2 Discretizing Deriv atives, 2d case 
Here we discretize f : R2 R on a grid: → 
f(k,k)f(k+1,k+1)
f(k+1,k)
f(k+1,k-1) f(k,k-1) f(k-1,k-1)f(k-1,k)f(k-1,k+1) f(k,k+1)
To compute the discrete derivative in the x and y directions, we’ll just look at a little piece . On the 
df df horizon tal edges, we appro ximate dx up to scaling, and do likewise on the vertical edges with dy : 
2-8 � � 
� 
f(k+1,k)-f(k,k)
f(k,k)-f(k,k-1)f(k,k)-f(k-1,k)f(k,k+1)-f(k,k)Again, the discrete deriv ative of f is a function on edges. When we consider the concatenation of the 
two discretization of the directional deriv atives, we see that the discretization of the gradien t, up to scaling, 
is �Gn,m f. Finally we use this to compute the discretized Laplacian, up to scaling, and get: 
f(k,k+1)+f(k,k-1)+f(k+1, k)+f(k-1, k)
 -4 f(k,k)
Thus the discretized Laplacian in two dimensions of f is −LGn,m f. 
5.3 A Note on Fourier Coeﬃcien ts 
We observ ed that paths and rings had eigen vectors that looked like Fourier coeﬃcients. In the continuous 
case: 
d2 sin(kx + c) = k2 sin(kx + c)dx2 
d2 cos(kx + c) = k2 cos(kx + c)dx2 
Thus sin(kx + c) and cos(kx + c) are eigenfun ctions of the d2 operator, i.e. the 1d Laplacian, both with dx2 
eigen value k2 . 
6 Bounding Laplacian Eigen values 
Lemma 21 (Sum of the eigen values) Given an n-vertex graph G with degrees di, wher e dmax = maxi di, 
and Laplacian LG with eigenvalues λi, 
λi = di ≤ dmaxn (8) 
ii 
Proof The ﬁrst two express ions are both the trace, the upper bound is trivial. 
Lemma 22 (Bounds on λ2 and λn) Given λi and di as above, 
diλ2 ≤ n − i 
1 (9) 
2-9 � 
�� 
�
�	 �� 7 λn ≥ n − i d
1 i	(10) 
Proof By the previous slide and the fact that λ1 = 0, we get n
i=2 λi = i di. As λ2 ≤ ··· ≤ λn, the 
bounds follow immediately . 
Bounding λ2 and λmax 
Theorem 23 (Couran t-Fisc her Formula) For any n × n symmetric matrix A, 
xT Ax λ1 = min x T Ax = min 
||x||=1 x=0 xT x 
xT Ax λ2 = min x T Ax = min	 (11)x=0 xT x ||x||=1 �
x⊥v1 x⊥v1 
xT Ax λmax = max x T Ax = max 
x=0 xT x ||x||=1 �
Proof We consider the diagonalization A = QT ΛQ. As seen earlier, xT Ax =(Qx)T Λ(Qx). As Q is 
orthogonal, we also have ||Qx|| = x. Thus it suﬃce s to consider diagonal matrices. Moreo ver, all of the 
equalities on the right follow immediately from linearit y. Thus we need to consider, for ||x|| = 1: 
⎛ ⎞⎛⎞ λ1 x1 � 
T Λx =(x1 ··· ⎜ ⎟⎜ . ⎟� λ
xix
i 2 
x xn) ⎝ ... ⎠⎝ .. ⎠ = λixi 2 = � 2 i . 
λn xn 
We compute the gradien t and ﬁnd: 
�� �� 2λixi 2λix3 
i 3�x x T Λx i = � x2 
i − 
( � x2 
i )2 =2λi(xi − xi ) 
thus all extremal values occur when one xi = 1 and the rest are 0. The identities follow immediately . 
Corollary 24 (Rayleigh Quotien t) Letting G =(V, E) be a graph with Laplacian LG, 
λ1 =	0 v1 = 1 
xT LGx (i,j)∈E (xi − xj )2 
λ2 =	min xT x = Pmin� 2 x⊥v1 x=0 i∈V xi (12)x=0 x=0 
xT LGx � 
(i,j)∈E (xi − xj )2 
λmax = max = max � 2 x=0�xT x x=0�i∈V xi 
The Rayleigh Quotien t is a useful tool for bounding graph spectra. Whereas before we had to consider 
all possible vectors x, now in order to get an upper bound on λ2 we need only produce a vector with small 
Rayleigh quotien t. Likewise to get a lower bound on λmax we need only to ﬁnd a vector with large Rayleigh 
quotien t. 
Examples next lecture! 
2-10 MIT OpenCourseWare
http://ocw.mit.edu 
For information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms. 18.409 Topics in Theoretical Computer Science: An Algorithmist's Toolkit
Fall 2009 